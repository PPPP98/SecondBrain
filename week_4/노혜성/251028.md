# PNPM 10.19.0의 Breaking Changes

PNPM 10.19.0의 주요 breaking changes와 대응 방법을 정리했습니다.[1][2]

## 주요 Breaking Changes

### 1. Lifecycle Scripts 기본 비활성화 (가장 중요)

의존성 패키지의 lifecycle scripts(preinstall, install, postinstall 등)가 **기본적으로 실행되지 않습니다**. 이는 보안 강화를 위한 변경사항입니다.[3][4][1]

**대응 방법:**

`package.json`에 `pnpm.onlyBuiltDependencies` 필드를 추가하여 신뢰하는 패키지만 허용합니다:[1]

```json
{
  "pnpm": {
    "onlyBuiltDependencies": ["fsevents", "esbuild", "sharp"]
  }
}
```

또는 `pnpm approve-builds` 명령어를 실행하여 대화식으로 패키지를 선택할 수 있습니다.[5]

### 2. pnpm link 동작 변경

`pnpm link` 명령어가 이제 루트 `package.json`에 overrides를 추가합니다. 전역 링크를 만들려면 패키지 디렉토리에서 `pnpm link`를 실행하면 됩니다(이전의 `pnpm link -g` 불필요).[6][1]

### 3. 보안 해시 SHA256 업그레이드

모든 해시 알고리즘이 SHA256으로 업그레이드되어 lockfile이 변경됩니다. 처음 마이그레이션 시 `pnpm-lock.yaml`이 업데이트됩니다.[6][1]

### 4. 설정 변경

**manage-package-manager-versions**: 기본적으로 활성화되어 `package.json`의 `packageManager` 필드 기반으로 pnpm 버전을 자동 관리합니다.[1][6]

**public-hoist-pattern**: 더 이상 기본적으로 패키지를 hoisting하지 않습니다. eslint나 prettier 관련 패키지도 루트로 hoisting되지 않습니다.[6][1]

**NODE_ENV=production**: 이제 devDependencies도 함께 설치됩니다. 프로덕션 의존성만 설치하려면 `pnpm add --prod`를 사용해야 합니다.[1][6]

### 5. Global Store v10 업그레이드

Store 버전이 v10으로 업그레이드되어 인덱스 파일 구조가 변경되었습니다. 처음 실행 시 자동으로 마이그레이션됩니다.[6][1]

## 마이그레이션 단계

### 1단계: PNPM 10 설치

```bash
# 기존 pnpm 제거
npm uninstall -g pnpm

# Corepack 사용 (권장)
corepack enable
corepack prepare pnpm@latest --activate
```

### 2단계: package.json 업데이트

```json
{
  "packageManager": "pnpm@10.19.0",
  "pnpm": {
    "onlyBuiltDependencies": []
  }
}
```

### 3단계: 빌드 스크립트 필요 패키지 확인

```bash
pnpm install
```

설치 중 스크립트가 필요한 패키지가 있다면 에러 메시지를 확인하고, 해당 패키지를 `onlyBuiltDependencies`에 추가합니다.[7][5]

### 4단계: 대화식으로 허용

```bash
pnpm approve-builds
```

이 명령어로 신뢰하는 패키지를 선택적으로 활성화할 수 있습니다.[5]

## React + Tailwind 프로젝트에서 주의사항

React 18.3.1과 Tailwind CSS 3.4.17을 사용하는 프로젝트에서는 일반적으로 **esbuild, fsevents(Mac), sharp** 등의 네이티브 바이너리를 사용하는 패키지만 `onlyBuiltDependencies`에 추가하면 됩니다.[7][3]

Vite는 esbuild를 사용하므로, esbuild가 목록에 포함되어야 합니다.[7]

## 결론

PNPM 10은 보안이 크게 강화되었지만, lifecycle scripts 비활성화로 인해 일부 패키지에서 수동 설정이 필요합니다. 처음 마이그레이션 시 약 10-30분 정도 시간을 투자하여 필요한 패키지를 확인하고 설정하면, 이후에는 안정적으로 사용할 수 있습니다.[2][4][5][1]

[1](https://github.com/orgs/pnpm/discussions/8945)
[2](https://www.x-cmd.com/blog/250115/)
[3](https://progosling.com/en/dev-digest/pnpm-10-blocks-lifecycle-scripts)
[4](https://socket.dev/blog/pnpm-10-0-0-blocks-lifecycle-scripts-by-default)
[5](https://github.com/pnpm/pnpm/issues/9032)
[6](https://en.kelen.cc/share/pnpm-v10-update-highlights)
[7](https://github.com/mswjs/msw/discussions/2413)
[8](https://github.com/pnpm/pnpm/releases)
[9](https://www.reddit.com/r/node/comments/1njqwmd/pnpm_v1016_introduces_a_new_setting_for_delayed/)
[10](https://vercel.com/changelog/automatic-pnpm-v10-support)
[11](https://github.com/pnpm/pnpm/issues/8949)
[12](https://pnpm.io/9.x/cli/self-update)
[13](https://github.com/pnpm/pnpm/issues/9210)
[14](https://pnpm.io/settings)
[15](https://pnpm.io/blog/releases/10.15)
[16](https://pnpm.io/installation)
[17](https://www.reddit.com/r/node/comments/1hzsssp/pnpm_will_no_longer_run_lifecycle_scripts_by/)
[18](https://storybook.js.org/docs/releases/migration-guide)
[19](https://news.ycombinator.com/item?id=45040282)
[20](https://x.com/pnpmjs)